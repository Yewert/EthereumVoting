from web3 import Web3, HTTPProvider

abi = '[{"constant":true,"inputs":[{"name":"index","type":"uint256"}],"name":"getCandidate","outputs":[{"name":"","type":"bytes"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"index","type":"uint256"}],"name":"getCandidateVotes","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"voterId","type":"uint256"},{"name":"candidateIndex","type":"uint256"}],"name":"vote","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"voter","type":"uint256"}],"name":"hasVoted","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"candidates","type":"bytes"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]'
bytecode = '608060405234801561001057600080fd5b50604051610910380380610910833981018060405281019080805182019291905050506000336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600260006040519080825280601f01601f1916602001820160405280156100ab5781602001602082028038833980820191505090505b5090806001815401808255809150509060018203906000526020600020016000909192909190915090805190602001906100e6929190610356565b5050600090505b815181101561034f5760007f010000000000000000000000000000000000000000000000000000000000000002828281518110151561012857fe5b9060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916141561021357600260006040519080825280601f01601f1916602001820160405280156101d15781602001602082028038833980820191505090505b50908060018154018082558091505090600182039060005260206000200160009091929091909150908051906020019061020c929190610356565b5050610342565b600260016002805490500381548110151561022a57fe5b90600052602060002001828281518110151561024257fe5b9060200101517f010000000000000000000000000000000000000000000000000000000000000090047f01000000000000000000000000000000000000000000000000000000000000000290808054603f811680603e81146102c0576002830184556001831615156102b2578192505b6001600284040193506102da565b83600052602060002060ff19841681556041855560209450505b50505090600182038154600116156103015790600052602060002090602091828204019190065b90919290919091601f036101000a81548160ff021916907f010000000000000000000000000000000000000000000000000000000000000084040217905550505b80806001019150506100ed565b50506103fb565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061039757805160ff19168380011785556103c5565b828001600101855582156103c5579182015b828111156103c45782518255916020019190600101906103a9565b5b5090506103d291906103d6565b5090565b6103f891905b808211156103f45760008160009055506001016103dc565b5090565b90565b6105068061040a6000396000f300608060405260043610610062576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806335b8e82014610067578063866163c01461010d578063b384abef1461014e578063ecca031f14610185575b600080fd5b34801561007357600080fd5b50610092600480360381019080803590602001909291905050506101ca565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100d25780820151818401526020810190506100b7565b50505050905090810190601f1680156100ff5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561011957600080fd5b50610138600480360381019080803590602001909291905050506102e0565b6040518082815260200191505060405180910390f35b34801561015a57600080fd5b506101836004803603810190808035906020019092919080359060200190929190505050610358565b005b34801561019157600080fd5b506101b060048036038101908080359060200190929190505050610428565b604051808215151515815260200191505060405180910390f35b60606000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561022757600080fd5b60028281548110151561023657fe5b906000526020600020018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156102d45780601f106102a9576101008083540402835291602001916102d4565b820191906000526020600020905b8154815290600101906020018083116102b757829003601f168201915b50505050509050919050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561033d57600080fd5b60016000838152602001908152602001600020549050919050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480156103ba57506103b882610428565b155b80156103ca575060028054905081105b15156103d557600080fd5b600382908060018154018082558091505090600182039060005260206000200160009091929091909150555060016000828152602001908152602001600020600081548092919060010191905055505050565b6000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561048657600080fd5b600090505b6003805490508110156104cf576003818154811015156104a757fe5b90600052602060002001548314156104c257600191506104d4565b808060010191505061048b565b600091505b509190505600a165627a7a72305820b5c7b5f58f291c38130fdf90705c8e23cc5ec71db2811cd2df668fd979f139250029'

w3 = Web3(HTTPProvider("http://127.0.0.1:7545"))
w3.eth.defaultAccount = w3.eth.accounts[0]

contract = w3.eth.contract(abi=abi, bytecode=bytecode)
tx_hash = contract.constructor(b'\1\2\0\3\4').transact()
tx_receipt = w3.eth.waitForTransactionReceipt(tx_hash)
contract_instance = w3.eth.contract(
    address=tx_receipt.contractAddress,
    abi=abi,
)

print(contract_instance.functions.getCandidate(0).call())
tx_hash = contract_instance.functions.vote(0, 0).transact()
tx_receipt = w3.eth.waitForTransactionReceipt(tx_hash)
print(tx_receipt.__dict__)
print(contract_instance.functions.getCandidateVotes(0).call())
